<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>War Room - GitHub Version</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { font-family: 'Sarabun', sans-serif; background: #2c3e50; color: white; text-align: center; margin: 0; }
        .triage-box { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .btn { padding: 20px; border-radius: 10px; font-size: 1.5rem; font-weight: bold; cursor: pointer; border: none; color: white; }
        .red { background: #e74c3c; } .yellow { background: #f1c40f; color: black; }
        .green { background: #2ecc71; } .black { background: #333; }
        .log-box { background: rgba(0,0,0,0.3); margin: 20px; padding: 15px; border-radius: 10px; height: 200px; overflow-y: auto; text-align: left; }
    </style>
</head>
<body>
    <h1>üö® War Room Real-time</h1>
    <div id="status">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö...</div>

    <div class="triage-box">
        <button class="btn red" onclick="updateTriage('red')">‡πÅ‡∏î‡∏á: <span id="r">0</span></button>
        <button class="btn yellow" onclick="updateTriage('yellow')">‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á: <span id="y">0</span></button>
        <button class="btn green" onclick="updateTriage('green')">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß: <span id="g">0</span></button>
        <button class="btn black" onclick="updateTriage('black')">‡∏î‡∏≥: <span id="b">0</span></button>
    </div>

    <div class="log-box" id="logs"></div>

    <script>
    // üö© ‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏Å‡πä‡∏≠‡∏õ‡∏°‡∏≤‡∏à‡∏≤‡∏Å Google Apps Script ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö
    const API_URL = "https://script.google.com/macros/s/AKfycbw1MKCd5CFAKJO6D7dxsdB16ZA5R--hvpUvS00maosKx3meWjQLwzevgTJ1atnHzdm8/exec"; 

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î Triage ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
    async function refreshTriage() {
        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'getState' })
            });
            const data = await response.json();
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
            document.getElementById('r').innerText = data.triage.red;
            document.getElementById('y').innerText = data.triage.yellow;
            document.getElementById('g').innerText = data.triage.green;
            document.getElementById('b').innerText = data.triage.black;
        } catch (e) {
            console.log("Error fetching data...");
        }
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏ß‡∏Å‡πÄ‡∏•‡∏Ç (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏µ‡∏ï‡πà‡∏≤‡∏á‡πÜ)
    async function updateTriage(color) {
        // ‡πÇ‡∏ä‡∏ß‡πå Loading ‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß
        Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });

        try {
            await fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'updateTriage', color: color, amount: 1 })
            });
            Swal.close();
            refreshTriage(); // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏¢‡∏≠‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        } catch (e) {
            Swal.fire('Error', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'error');
        }
    }

    // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏¢‡∏≠‡∏î‡∏ó‡∏∏‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    setInterval(refreshTriage, 5000);
    refreshTriage(); // ‡∏£‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
</script>
</body>
</html>
